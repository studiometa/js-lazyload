Lazy=function(e){"use strict";function t(){c=window.innerWidth||document.documentElement.clientWidth,d=window.innerHeight||document.documentElement.clientHeight}function i(e,t){var i=0;return function(){var n=+new Date;t>n-i||(i=n,e())}}if(!(this instanceof Lazy))return new Lazy(e);var n=this;n.options={src:"data-src",selector:".js-lazy",separator:" | ",breakpoints:[],offset:100,onError:null,errorClass:"has-error",onSuccess:null,successClass:"is-loaded"},$.extend(!0,n.options,e);var s=n.options,o=[],r=s.src,a=window.devicePixelRatio>1,c=window.innerWidth,d=window.innerHeight;return n.validate=function(){return n.$images.each(function(e,t){var i=$(this);(n.isInViewport(this)||i.hasClass(s.successClass))&&n.load(this)}),0===o.length?(n.destroy(),!1):void 0},n.load=function(e){var t=$(e),i=t.attr(r)||t.attr(s.src);if(i){var n=i.split(s.separator),c=n[a&&n.length>1?1:0],d=new Image;$.each(s.breakpoints,function(e,i){t.removeAttr(i.src)}),t.removeAttr(s.src),d.onerror=function(){s.onError&&s.onError(e,"invalid"),t.addClass(s.errorClass)},d.onload=function(){"img"===e.nodeName.toLowerCase()?e.src=c:t.css("background-image",'url("'+c+'")'),t.addClass(s.successClass),s.onSuccess&&s.onSuccess(e)},d.src=c,o.splice($.inArray(e,o),1)}},n.isInViewport=function(e){var t=e.getBoundingClientRect(),i=d+s.offset;return t.top>=0&&t.top<=i||t.bottom<=i&&t.bottom>=0-s.offset},n.init=function(){n.destroyed=!0,n.$images=$(s.selector),n.$images.each(function(e,t){o.push(this)}),t(),n.validateT=i(n.validate,250),n.updateSizesT=i(t,500),$.each(s.breakpoints,function(e,t){return t.width<=c?(r=t.src,!1):void 0}),n.destroyed&&(n.destroyed=!1,$(window).on({resize:n.updateSizesT,resize:n.validateT,scroll:n.validateT})),n.validate()},$(window).on("load",function(){n.init()}),n},Lazy.prototype={revalidate:function(){var e=this;e.destroyed||e.validate()},reInit:function(){var e=this;e.$images=$(e.options.selector).not("."+e.options.successClass),e.$images&&(e.destroyed=!1,e.revalidate())},destroy:function(){var e=this;e.destroyed=!0,$(window).off({resize:e.updateSizesT,resize:e.validateT,scroll:e.validateT}),e.$images=null}};