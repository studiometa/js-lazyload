var Lazy=Lazy||{};!function(){"use strict";function e(e){console.log("lazy:isInViewport");var t=e.getBoundingClientRect(),o=d+n.offset;return t.top>=0&&t.top<=o||t.bottom<=o&&t.bottom>=0-n.offset}function t(){console.log("lazy:updateSizes"),l=window.innerWidth||document.documentElement.clientWidth,d=window.innerHeight||document.documentElement.clientHeight}function o(e,t){console.log("lazy:throttle");var o=0;return function(){var a=+new Date;t>a-o||(o=a,e())}}var a,n,i,s,r=window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.5), only screen and (min--moz-device-pixel-ratio: 1.5), only screen and (min-resolution: 240dppx)").matches,l=window.innerWidth,d=window.innerHeight,c=$(window);Lazy=function(d){return console.log("lazy"),this instanceof Lazy?(a=this,a.options={src:"data-src",selector:".js-lazy",separator:" | ",breakpoints:[{width:1440,src:"data-src-larger"},{width:1280,src:"data-src-large"},{width:992,src:"data-src-medium"},{width:768,src:"data-src-small"},{width:480,src:"data-src-smaller"}],offset:window.innerHeight/2,onError:function(){},errorClass:"has-error",onSuccess:function(){},successClass:"is-loaded"},$.extend(!0,a.options,d),n=a.options,i=[],s=n.src,a.validate=function(t){return console.log("lazy:validate"),a.$images.each(function(o,i){var s=$(this);(e(this)||s.hasClass(n.successClass)||t)&&a.load(this)}),0===i.length?(a.destroy(),!1):void 0},a.load=function(e){console.log("lazy:load");var t=$(e),o=t.attr(s)||t.attr(n.src);if(o){var a=o.split(n.separator),l=a[r&&a.length>1?1:0],d=new Image;$.each(n.breakpoints,function(e,o){t.removeAttr(o.src)}),t.removeAttr(n.src),d.onerror=function(){n.onError&&n.onError(e,"invalid"),t.addClass(n.errorClass)},d.onload=function(){if("img"===e.nodeName.toLowerCase())e.src=l;else if("image"===e.nodeName.toLowerCase()){var o=document.createElementNS("http://www.w3.org/2000/svg","image");o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l),o.setAttribute("x",e.getAttribute("x")),o.setAttribute("y",e.getAttribute("y")),o.setAttribute("width",e.width.baseVal.value),o.setAttribute("height",e.height.baseVal.value),e.parentNode.appendChild(o),e.remove()}else t.css("background-image",'url("'+l+'")');t.addClass(n.successClass),n.onSuccess&&n.onSuccess(e)},d.src=l,i.splice($.inArray(e,i),1)}},a.init=function(){console.log("lazy:init"),a.destroyed=!0,a.$images=$(n.selector),a.$images.each(function(e,t){i.push(this)}),t(),a.validateT=o(a.validate,250),a.updateSizesT=o(t,500),a.updateAndValidateT=function(){a.updateSizesT(),a.validateT()},$.each(n.breakpoints,function(e,t){return t.width<=l?(s=t.src,!1):void 0}),a.destroyed&&(a.destroyed=!1,c.on({resize:a.updateAndValidateT,scroll:a.validateT})),a.validate()},a):new Lazy(d)},Lazy.prototype.revalidate=function(e){console.log("lazy:revalidate"),a.destroyed||a.validate(e)},Lazy.prototype.reInit=function(){return console.log("lazy:reInit"),a.$images=$(a.options.selector).not("."+a.options.successClass),a.$images&&(a.destroyed=!1,a.revalidate()),a},Lazy.prototype.destroy=function(){console.log("lazy:destroy"),a.destroyed=!0,c.off({resize:a.updateAndValidateT,scroll:a.validateT}),a.$images=null}}();